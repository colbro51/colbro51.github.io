<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="theme-color" content="#1976d2">

  <!-- iOS Safari fullscreen support (still fine even if not installing PWA) -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">

  <title>F&B Summer Camp</title>

  <link rel="manifest" href="/camp/manifest.json">
  <link rel="apple-touch-icon" sizes="180x180" href="/camp/apple-icon-180.png">
  <link rel="stylesheet" href="style.css">

  <script type="module" src="camp-data.js"></script>
  <script type="module" src="logic.js"></script>
  <script type="module" src="maps.js"></script>
  <script type="module" src="ui.js"></script>

  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("/camp/service-worker.js");
    }
  </script>

</head>

<body>

  <!-- ANDROID INSTALL SCREEN (unchanged) -->
  <div id="install" class="screen">
    <h1>Install This App</h1>
    <p>To use this app, please install it to your home screen.</p>
    <p>Open the browser menu → "Add to Home Screen".</p>
    <p>If you already have an older version installed, please remove it first.</p>
  </div>

  <!-- MAIN SCREEN -->
  <div id="main" class="screen active">
    <h1 id="title"></h1>

    <div class="checkbox-row">
      <label>
        <input type="checkbox" id="startFromCamp" checked>
        Start from camp
      </label>

      <label id="useGoogleMapsLabel">
        <input type="checkbox" id="useGoogleMaps" checked>
        Use Google Maps
      </label>

      <label>
        <input type="checkbox" id="helpToggle">
        Help
      </label>
    </div>

    <button class="btn mainbtn" id="btn_camp">Camp Location</button>

    <button class="btn mainbtn" id="btn_mon">Monday</button>
    <button class="btn mainbtn" id="btn_tue">Tuesday</button>
    <button class="btn mainbtn" id="btn_wed">Wednesday</button>
    <button class="btn mainbtn" id="btn_thu">Thursday</button>
    <button class="btn mainbtn" id="btn_fri">Friday</button>
    <button class="btn mainbtn" id="btn_more">Meals & More</button>
  </div>

  <!-- HELP PANEL -->
  <div id="helpPanel" class="screen">
    <h1>Help</h1>
    <p>Actioning a destination button</p>
    <p>Single tap → walk details</p>
    <p>Long press → opens maps app</p>

    <div id="androidHelpNote" style="margin-top:20px; text-align:left; font-size:17px; line-height:1.4;">
      <strong>Android / Samsung Tip</strong><br>
      After launching Google Maps, use your phone’s <strong>Back button repeatedly</strong> to return here.
    </div>

    <button class="backonly" id="back_help">⬅ Go Back</button>
  </div>

  <!-- VIEWER -->
  <div id="viewer" class="screen">
    <img id="viewerImage" alt="">
    <button class="backonly" id="viewerBack">⬅ Go Back</button>
  </div>

  <!-- DAY SCREENS -->
  <!-- (unchanged — omitted here for brevity but identical to your original) -->

  <!-- MAPS FAILURE MODAL -->
  <div id="mapsFailModal" class="modal" role="dialog" aria-modal="true">
    <div class="modal-content">
      <h2>Google Maps Didn’t Open</h2>
      <p>Your device didn’t switch to the Google Maps app.</p>
      <ul>
        <li>Maps app isn’t installed</li>
        <li>Your device opens links in the browser</li>
        <li>iOS kept the link inside the PWA</li>
      </ul>
      <button class="modal-btn" id="modal_ok">OK</button>
    </div>
  </div>

  <!-- ------------------------------------------------------------ -->
  <!-- iOS SAFARI-ONLY REDIRECT (NEW) -->
  <!-- ------------------------------------------------------------ -->
<script>
function isIosSafari() {
  const ua = navigator.userAgent.toLowerCase();
  const isIOS = /iphone|ipad|ipod/.test(ua);
  const isSafari = !ua.includes("crios") && !ua.includes("fxios") && !ua.includes("chrome");
  return isIOS && isSafari;
}

function isStandalone() {
  return window.navigator.standalone === true ||
         window.matchMedia("(display-mode: standalone)").matches;
}

function isRealAndroid() {
  return navigator.userAgent.includes("Android") &&
         navigator.userAgent.includes("Mobile") &&
         !navigator.userAgent.includes("Windows") &&
         !navigator.userAgent.includes("CrOS");
}

window.addEventListener("DOMContentLoaded", () => {
  const standalone = isStandalone();

  // iOS → Safari-only instructions
  if (!standalone && isIosSafari()) {
    window.location.href = "/camp/ios-safari-home.html";
    return;
  }

  // Android → dedicated install page
  if (!standalone && isRealAndroid()) {
    window.location.href = "/camp/android-install.html";
    return;
  }

  // Desktop or installed → continue normally
});
</script>

</body>
</html>